---
// src/components/BackgroundWrapper.astro
import hero1 from "../assets/banners/hero-bg-1.png";
import hero2 from "../assets/banners/hero-bg-2.png";
import hero3 from "../assets/banners/hero-bg-3.png";
import hero5 from "../assets/banners/hero-bg-5.png";

const imgs = [hero1, hero2, hero3, hero5];
const fallback = imgs[0].src;
---

<div
  id="bgwrap"
  class="relative w-full overflow-hidden bg-cover bg-center transition-opacity duration-300 opacity-0"
  style={`background-image:url(${fallback});`}
  data-bgs={JSON.stringify(imgs.map(i => i.src))}
>
  <div class="pointer-events-none absolute inset-0 bg-black/20"></div>
  <div class="pointer-events-none absolute inset-x-0 bottom-0 h-40 bg-gradient-to-b from-transparent via-black/60 to-[#141414]"></div>
  <div class="relative z-[2]"><slot /></div>
</div>

<script is:inline>
  (() => {
    const el = document.getElementById('bgwrap');
    if (!el) return;
    try {
      const list = JSON.parse(el.dataset.bgs || '[]');
      if (Array.isArray(list) && list.length > 0) {
        const idx = Math.floor(Math.random() * list.length);
        el.style.backgroundImage = `url(${list[idx]})`;
      }
    } catch {}
    requestAnimationFrame(() => { el.classList.remove('opacity-0'); });
  })();
</script>
